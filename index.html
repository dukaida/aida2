<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Imágenes con puntuación</title>
    <style>
        .image-container {
            display: flex;
            justify-content: space-around;
        }
        img {
            width: 300px;
            height: 300px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <h2>Selecciona una imagen y dale una puntuación</h2>

    <div class="image-container">
        <img src="imagen1.jpeg" alt="Imagen 1" onclick="seleccionarImagen('imagen1')">
        <img src="imagen2.jpeg" alt="Imagen 2" onclick="seleccionarImagen('imagen2')">
        <img src="imagen3.jpeg" alt="Imagen 3" onclick="seleccionarImagen('imagen3')">
    </div>

    <div id="puntuacion-section" style="margin-top: 20px; display: none;">
        <label for="puntuacion">Ingresa una puntuación (1 a 10): </label>
        <input type="number" id="puntuacion" min="1" max="10">
        <button onclick="guardarPuntuacion()">Guardar Puntuación</button>
    </div>

    <div id="resultado-section" style="margin-top: 20px;">
        <h3>Promedios:</h3>
        <p id="promedio1">Imagen 1: -</p>
        <p id="promedio2">Imagen 2: -</p>
        <p id="promedio3">Imagen 3: -</p>
    </div>

    <script>
        let imagenSeleccionada = ''; // Variable temporal para almacenar el nombre de la imagen seleccionada

        function seleccionarImagen(nombreImagen) {
            imagenSeleccionada = nombreImagen;
            document.getElementById('puntuacion-section').style.display = 'block';
            document.getElementById('puntuacion').value = ''; // Limpia el campo de puntuación
        }

        function guardarPuntuacion() {
            let puntuacion = document.getElementById('puntuacion').value;
            if (puntuacion >= 1 && puntuacion <= 10) {
                // Obtener calificaciones previas de localStorage
                let calificaciones = JSON.parse(localStorage.getItem('calificaciones')) || {};

                // Si la imagen ya tiene calificaciones, añadimos la nueva puntuación
                if (calificaciones[imagenSeleccionada]) {
                    calificaciones[imagenSeleccionada].push(Number(puntuacion));
                } else {
                    // Si es la primera vez que se califica esta imagen, creamos un array
                    calificaciones[imagenSeleccionada] = [Number(puntuacion)];
                }

                // Guardar las calificaciones actualizadas en localStorage
                localStorage.setItem('calificaciones', JSON.stringify(calificaciones));

                // Calcular y mostrar el promedio actualizado
                mostrarPromedios();

                // Ocultar la sección de puntuación nuevamente
                document.getElementById('puntuacion-section').style.display = 'none';
            } else {
                alert('Por favor, ingresa una puntuación válida entre 1 y 10.');
            }
        }

        function mostrarPromedios() {
            let calificaciones = JSON.parse(localStorage.getItem('calificaciones')) || {};
            let promedio1 = calcularPromedio(calificaciones['imagen1']);
            let promedio2 = calcularPromedio(calificaciones['imagen2']);
            let promedio3 = calcularPromedio(calificaciones['imagen3']);

            // Mostrar los promedios en la página
            document.getElementById('promedio1').innerText = 'Imagen 1: ' + (promedio1 !== null ? promedio1.toFixed(2) : '-');
            document.getElementById('promedio2').innerText = 'Imagen 2: ' + (promedio2 !== null ? promedio2.toFixed(2) : '-');
            document.getElementById('promedio3').innerText = 'Imagen 3: ' + (promedio3 !== null ? promedio3.toFixed(2) : '-');
        }

        function calcularPromedio(puntuaciones) {
            if (!puntuaciones || puntuaciones.length === 0) {
                return null;
            }
            let suma = puntuaciones.reduce((a, b) => a + b, 0);
            return suma / puntuaciones.length;
        }

        // Mostrar los promedios al cargar la página
        window.onload = mostrarPromedios;
    </script>

</body>
</html>
